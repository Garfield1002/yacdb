<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=9" />
    <meta name="generator" content="Doxygen 1.9.4" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>YACDB: &lt;tt&gt;yac.db&lt;/tt&gt; File Specification</title>
    <link href="tabs.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="jquery.js"></script>
    <script type="text/javascript" src="dynsections.js"></script>
    <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
 <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
    <link href="doxygen.css" rel="stylesheet" type="text/css" />
    <link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
  </head>
  <body>
    <!-- https://tholman.com/github-corners/ -->
    <a
      href="https://github.com/Garfield1002/yacdb/"
      class="github-corner"
      aria-label="View source on GitHub"
      ><svg
        width="80"
        height="80"
        viewBox="0 0 250 250"
        style="
          fill: #70b7fd;
          color: #fff;
          position: absolute;
          top: 0;
          border: 0;
          right: 0;
        "
        aria-hidden="true"
      >
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path
          d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
          fill="currentColor"
          style="transform-origin: 130px 106px"
          class="octo-arm"
        ></path>
        <path
          d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
          fill="currentColor"
          class="octo-body"
        ></path></svg></a
    ><style>
      .github-corner:hover .octo-arm {
        animation: octocat-wave 560ms ease-in-out;
      }
      @keyframes octocat-wave {
        0%,
        100% {
          transform: rotate(0);
        }
        20%,
        60% {
          transform: rotate(-25deg);
        }
        40%,
        80% {
          transform: rotate(10deg);
        }
      }
      @media (max-width: 500px) {
        .github-corner:hover .octo-arm {
          animation: none;
        }
        .github-corner .octo-arm {
          animation: octocat-wave 560ms ease-in-out;
        }
      }
    </style>
    <div id="top">
      <!-- do not remove this div, it is closed by doxygen! -->
      <div id="titlearea">
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr style="height: 56px">
              <td id="projectlogo">
                <img alt="Logo" src="yacdb.png" />
              </td>
              <td id="projectalign" style="padding-left: 0.5em">
                <div id="projectname">
                  YACDB
                </div>
                <div id="projectbrief">Yet Another C(rappy) Database</div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <!-- end header part -->
    </div>
  </body>
</html>
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_server_side_diskio_fileSpecification.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title"><code>yac.db</code> File Specification </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md1"></a>
Pages</h1>
<p >The main database file consists of one or more pages. The size of a page is a power of two between 512 and 32768 inclusive. All pages within the same database are the same size. The page size for a database file is determined by the 2-byte integer located at an offset of 13 bytes from the beginning of the database file.</p>
<p >Pages are numbered beginning with 1. The maximum page number is 4294967294 (232 - 2). The minimum size yacDB database is a single 512-byte page. The maximum size database would be 2147483646 pages at 65536 bytes per page or 281,474,976,579,584 bytes (about 281 terabytes). Usually yacDB will hit the maximum file size limit of the underlying filesystem or disk hardware long before it hits its own internal size limit.</p>
<p >At any point in time, every page in the main database has a single use which is one of the following:</p>
<ul>
<li>A freelist page</li>
<li>A b-tree page<ul>
<li>A table b-tree interior page</li>
<li>A table b-tree leaf page</li>
<li>An index b-tree interior page</li>
<li>An index b-tree leaf page</li>
</ul>
</li>
<li>A payload overflow page</li>
</ul>
<p >All reads from and writes to the main database file begin at a page boundary and all writes are an integer number of pages in size. There is one exception to this rule: the database header.</p>
<p >Before any information-bearing page of the database is modified, the original unmodified content of that page is written into the rollback journal. If a transaction is interrupted and needs to be rolled back, the rollback journal can then be used to restore the database to its original state. Freelist leaf pages bear no information that would need to be restored on a rollback and so they are not written to the journal prior to modification, in order to reduce disk I/O.</p>
<h1><a class="anchor" id="autotoc_md2"></a>
Database Header</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Offset   </th><th class="markdownTableHeadNone">Size   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">13   </td><td class="markdownTableBodyNone">The header string: "YACDB format\0"    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">13   </td><td class="markdownTableBodyNone">2   </td><td class="markdownTableBodyNone">The database page size in bytes. Must be a power of two between 512 and 32768 inclusive.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">15   </td><td class="markdownTableBodyNone">4   </td><td class="markdownTableBodyNone">File change counter. (Currently unused)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">19   </td><td class="markdownTableBodyNone">4   </td><td class="markdownTableBodyNone">Size of the database file in pages. The "in-header database size".    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">23   </td><td class="markdownTableBodyNone">4   </td><td class="markdownTableBodyNone">Default page cache size.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">27   </td><td class="markdownTableBodyNone">4   </td><td class="markdownTableBodyNone">Number of free blocks.    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">31   </td><td class="markdownTableBodyNone">4   </td><td class="markdownTableBodyNone">First free block   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md3"></a>
Magic Header string</h2>
<p >Every valid YACDB file begins with the following 13 bytes (in hex): <code>59 41 43 44 42 20 66 6F 72 6D 61 74 00</code>. This byte sequence corresponds to the ASCII string "YACDB format" including the nul terminator character at the end.</p>
<h2><a class="anchor" id="autotoc_md4"></a>
Page Size</h2>
<p >The two-byte value beginning at offset 13 determines the page size of the database. This value is interpreted as a big-endian integer and must be a power of two between 512 and 32768, inclusive.</p>
<h2><a class="anchor" id="autotoc_md5"></a>
File change counter (Unused)</h2>
<p >A planned space for checking if cached pages are still valid.</p>
<h2><a class="anchor" id="autotoc_md6"></a>
In-header database size</h2>
<p >The 4-byte big-endian integer at offset 20 into the header stores the size of the database file in pages.</p>
<h2><a class="anchor" id="autotoc_md7"></a>
Suggested cache size</h2>
<p >The 4-byte big-endian signed integer at offset 24 is the suggested cache size in pages for the database file.</p>
<h2><a class="anchor" id="autotoc_md8"></a>
Number of free blocks</h2>
<p >The 4-byte big-endian signed integer at offset 28 is the current number of free blocks in the database.</p>
<h2><a class="anchor" id="autotoc_md9"></a>
First free block</h2>
<p >The 4-byte big-endian signed integer at offset 32 is the address of the first free blocks in the database.</p>
<h1><a class="anchor" id="autotoc_md10"></a>
The Freelist</h1>
<p >A database file might contain one or more pages that are not in active use. Unused pages can come about, for example, when information is deleted from the database. Unused pages are stored on the freelist and are reused when additional pages are required.</p>
<p >The freelist is organized as a linked list.</p>
<p >⚠ Unlike in SQlite, the free list is organized as a linked list. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
